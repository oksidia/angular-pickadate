!function(e){"use strict";function t(t,a){var n=[];return e.forEach(t,function(t){n.push(e.isFunction(a)?a(t):t[a])}),n}var a=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1};e.module("pickadate",[]).provider("pickadateI18n",function(){var e={prev:"prev",next:"next"};this.translations={},this.$get=function(){var t=this.translations;return{t:function(a){return t[a]||e[a]}}}}).factory("pickadateModalBindings",["$window","$document",function(e,t){var n=(void 0!==e.pageXOffset,"CSS1Compat"===(t.compatMode||""),function(a){var n=e.innerWidth||t.documentElement.clientWidth||t.body.clientWidth,i={top:a.getBoundingClientRect().bottom+"px"};return n-a.getBoundingClientRect().left>=300?i.left=a.getBoundingClientRect().left+"px":i.right=n-a.getBoundingClientRect().right+"px",i}),i=function(e,t){for(var a=t.parentNode;null!==a;){if(a===e)return!0;a=a.parentNode}return!1};return function(e,r,o){var s=function(t){e.displayPicker=t,e.$apply()};r.on("focus",function(){e.modalStyles=n(r[0]),s(!0)}),r.on("keydown",function(e){a.call([9,13,27],e.keyCode)>=0&&s(!1)}),t.on("click",function(e){i(o,e.target)||e.target===r[0]||s(!1)})}}]).factory("pickadateDateHelper",["$locale","dateFilter",function(t,a){function n(e){switch(e){case"dd":return"day";case"MM":return"month";case"yyyy":return"year"}}return function(i,r){var o,s,c,l,d,u;return r=r||{},i=i||"yyyy-MM-dd",d=r.weekStartsOn,u=r.noExtraRows,c=r.disabledDates||e.noop,(!e.isNumber(d)||d<0||d>6)&&(d=0),{parseDate:function(t){if(t){if(e.isDate(t))return new Date(t);if(r.useMoment){var a=moment(t,i);if(!a.isValid())return;return a.toDate()}var o="(dd|MM|yyyy)",s=i.match(/[^a-zA-Z]/)[0],c=t.split(s),l=new RegExp([o,o,o].join(s)),d=i.match(l),u={};if(d.shift(),e.forEach(d,function(e,t){u[n(e)]=parseInt(c[t],10)}),!(isNaN(u.year)||isNaN(u.month)||isNaN(u.day)))return new Date(u.year,u.month-1,u.day,3)}},setRestrictions:function(e){o=this.parseDate(e.minDate)||new Date(0),s=this.parseDate(e.maxDate)||new Date(99999999999999),l=e.currentDate},allowPrevMonth:function(){return l>o},allowNextMonth:function(){var t=e.copy(l);return t.setMonth(t.getMonth()+1),t<=s},buildDateObject:function(t){var n=e.copy(t),d=r.useMoment?moment(t).format(i):a(n,i),u=c({date:n,formattedDate:d}),f=this.getMonthOffset(n,l),p=n<o,h=n>s,D=f===-1&&!r.previousMonthSelectable||1===f&&!r.nextMonthSelectable,m=r.useMoment?moment().format(i):a(new Date,i);return{date:n,formattedDate:d,today:d===m,disabled:u,outOfMinRange:p,outOfMaxRange:h,monthOffset:f,enabled:!(u||p||h||D)}},buildDates:function(t,a,n){var i=[],r=new Date(t,a,1,3),o=new Date(t,a+1,0,3);for(n=n||{},l=e.copy(r);r.getDay()!==d;)r.setDate(r.getDate()-1);for(var s=0;s<42&&!(u&&r.getDay()===d&&r>o);s++)i.push(this.buildDateObject(r)),r.setDate(r.getDate()+1);return i},buildDayNames:function(){var e=t.DATETIME_FORMATS.SHORTDAY;if(d){e=e.slice(0);for(var a=0;a<d;a++)e.push(e.shift())}return e},getMonthOffset:function(e,t){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}}}}]).directive("pickadate",["$locale","$sce","$compile","$document","$window","pickadateDateHelper","pickadateI18n","pickadateModalBindings","filterFilter",function(n,i,r,o,s,c,l,d,u){var f='<div class="pickadate" ng-show="displayPicker" ng-style="modalStyles"><div class="pickadate-header"><div class="pickadate-controls"><a href="" class="pickadate-prev" ng-click="changeMonth(-1)" ng-show="allowPrevMonth">'+i.trustAsHtml(l.t("prev"))+'</a><a href="" class="pickadate-next" ng-click="changeMonth(1)" ng-show="allowNextMonth">'+i.trustAsHtml(l.t("next"))+'</a></div><h3 class="pickadate-centered-heading">{{currentDate | date:"MMMM yyyy"}}</h3></div><div class="pickadate-body"><div class="pickadate-main"><ul class="pickadate-cell"><li class="pickadate-head" ng-repeat="dayName in dayNames">{{dayName}}</li></ul><ul class="pickadate-cell"><li ng-repeat="dateObj in dates" ng-click="setDate(dateObj)" ng-class="classesFor(dateObj)">{{dateObj.date | date:"d"}}</li></ul></div></div></div>';return{require:"ngModel",scope:{defaultDate:"=",minDate:"=",maxDate:"=",disabledDates:"&",weekStartsOn:"=",useMoment:"=?"},link:function(n,i,o,s){function l(){var e=k.buildDates(n.currentDate.getFullYear(),n.currentDate.getMonth());n.allowPrevMonth=k.allowPrevMonth(),n.allowNextMonth=k.allowNextMonth(),n.dayNames=k.buildDayNames(),n.dates=t(e,function(e){return e.classNames=[e.enabled?"pickadate-enabled":"pickadate-disabled"],e.today&&e.classNames.push("pickadate-today"),e.disabled&&e.classNames.push("pickadate-unavailable"),e})}function p(e,a){a=a||{},m?s.$setViewValue(t(e,"formattedDate")):s.$setViewValue(e[0]&&e[0].formattedDate),a.skipRenderInput||i.val(s.$viewValue)}function h(e,n){var i=a.call(t(n,"formattedDate"),e.formattedDate);return i===-1?n=D(e,n):(v||n.length>1)&&n.splice(i,1),n}function D(e,t){return m?t.push(e):t=[e],t}var m=o.hasOwnProperty("multiple"),v=o.hasOwnProperty("allowBlankDate"),y=[],M=i[0]instanceof HTMLInputElement,g=r(f)(n),w=(o.format||"yyyy-MM-dd").replace(/m/g,"M"),k=c(w,{previousMonthSelectable:/^(previous|both)$/.test(o.selectOtherMonths),nextMonthSelectable:/^(next|both)$/.test(o.selectOtherMonths),weekStartsOn:n.weekStartsOn,noExtraRows:o.hasOwnProperty("noExtraRows"),disabledDates:n.disabledDates,useMoment:!!n.useMoment});n.displayPicker=!M,n.setDate=function(e){e.enabled&&(y=h(e,y),p(y),n.changeMonth(e.monthOffset),n.displayPicker=!M)};var b=s.$render=function(a){e.isArray(s.$viewValue)?y=s.$viewValue:s.$viewValue&&(y=[s.$viewValue]),n.currentDate=k.parseDate(n.defaultDate||y[0])||new Date,k.setRestrictions(n),y=t(y,function(e){return k.buildDateObject(k.parseDate(e))}),y=u(y,{enabled:!0}),p(y,a),l()};n.classesFor=function(e){var n=t(y,"formattedDate"),i=a.call(n,e.formattedDate)>=0?"pickadate-active":null;return e.classNames.concat(i)},n.changeMonth=function(e){e&&(n.currentDate.setDate(1),n.currentDate.setMonth(n.currentDate.getMonth()+e),l())},n.$watch(function(){return e.toJson([n.minDate,n.maxDate])},b),M?(d(n,i,g[0]),n.$watch(function(){return s.$viewValue},function(e){var t=k.parseDate(e);t&&b({skipRenderInput:!0}),s.$setValidity("date",!!t)}),n.$$postDigest(function(){o.value&&(s.$viewValue=o.value,b())}),i.after(g.addClass("pickadate-modal"))):i.append(g)}}}])}(window.angular);